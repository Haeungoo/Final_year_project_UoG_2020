<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="messageMapper">


<!-- insert the message -->
<insert id="writeMessage" parameterType="com.fyp.vo.MessageVO">
INSERT INTO FYP_MESSAGE (MNO, CNO, CONTENT, USER1)
VALUES (HAEUN_MESSAGE_SEQ.NEXTVAL, #{cno}, #{content}, #{user1})
</insert>

<!-- select the message -->
<select id="readMessages" resultType="com.fyp.vo.MessageVO">
SELECT MNO, CONTENT, USER1, SENDDATE
FROM FYP_MESSAGE
WHERE CNO = #{cno}
ORDER BY MNO
</select>

<!-- select the message -->
<select id="readMessagesSince" resultType="com.fyp.vo.MessageVO">
SELECT FYP_MESSAGE.MNO, FYP_MESSAGE.USER1, FYP_MESSAGE.CONTENT, FYP_MESSAGE.SENDDATE
FROM FYP_MESSAGE
INNER JOIN FYP_CHAT
ON FYP_CHAT.CNO = FYP_MESSAGE.CNO
WHERE FYP_MESSAGE.CNO = #{cno}
AND FYP_MESSAGE.MNO > #{mno}
ORDER BY FYP_MESSAGE.MNO
</select>

</mapper>